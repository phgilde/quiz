{% extends "base.html" %}

{% block content %}
<div class="py-5 bg-light">
  <div class="container">
    <div class="card text-center">
      <div id="quiz">
      <div class="card-body">
        <h1><p id="name-label">Dein Name</p></h1>
        <input id="name" type="text">
        <input id="send-name" type="button" class="btn btn-success" value="Weiter">
        <b><h1><p id="question"></p></h1></b>
        <div id="answers" class=""></div>
        <form action="" method="POST">
            {{form.hidden_tag()}}
            {{form.name()}}
            {{form.answers()}}
            {{form.submit()}}
        </form>
      </div>
    </div>
    </div>
  </div>
</div>
    <script>
        $("form").hide();
        var questions = {{questions|tojson|safe}};
        var answers = {{answers|tojson|safe}};
        var result = []
        var i = 0;
        updateQuiz = function(clicked) {
            return function(){

                result.push(clicked);
                $("#answers").empty();
                $("#question").empty();

                if(i==questions.length) {
                    $("form").show();
                    $("form :text").hide();
                    $("form #name").val(name);
                    $("form #answers").val(result.join(" "));
                }

                $("#question").html(questions[i]);
                for(var j = 0; j<answers[i].length; j++) {
                    $("#answers").append($('<button class="btn btn-info"></button>').html(answers[i][j]).click(updateQuiz(j)));
                }


                i += 1;

            }
        }
        nameSubmitFunc = function() {
            if ($("#name").val().length > 1) {
                $("#name-label").hide();
                $("#name").hide();
                $("#send-name").hide();
                var name = $("#name").val();
                updateQuiz(0)();
                result.pop()
            } else {
                alert("Bitte gebe einen Namen ein");
            }
        }
        $("#send-name").click(nameSubmitFunc);
    </script>
</div>
{% endblock %}
